{% ckan_extends %}

{% set tags = h.get_facet_items_dict('tags', c.search_facets, limit=5) %}
{% set organizations = h.get_facet_items_dict('organization', c.search_facets, limit=5) %}

{% block content %}
<main id="content">
  {{ self.flash() }}
  {% snippet "snippets/pdae_theme_header_search.html", title="Busca en nuestro catálogo de Datos Abiertos", query=q %}
  <section class="section has-bg-image text-white" style="background-image: url(/images/textura-roja.jpg);">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2">
          <div class="text-center">
            <h2 class="fs-35 fw-light">
              Datos de <span class="fw-bold">la pandemia</span>
            </h2>
            <p class="fs-22">
              ¿Quieres conocer los datos que se han generado durante la pandemia por COVID-19 en Ecuador?
            </p>
            <a href="#" class="btn btn-lg btn-light mt-16">
              Explorar
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="bg-cultured section-lg">
    <div class="container">
      <div class="text-center">
        <h2 class="text-sinopia fw-bold fs-45">
          Novedades
        </h2>
        <p class="fs-22 text-blue-sapphire">
          Conoce los conjuntos de datos <span class="fw-bold">agregados o actualizados recientemente</span>
        </p>
      </div>
      {% set latest_datasets = h.pdae_theme_get_datasets() %}
      {% if latest_datasets %}
        <div class="mt-32">
          {{ h.snippet('home/snippets/pdae_theme_datasets_slider.html', datasets=latest_datasets) }}
        </div>
      {% endif %}
    </div>
  </section>
  <section class="text-white">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-6 has-bg-image" style="background-image: url(/images/waves-blue.jpg);">
          <div class="section d-flex flex-column align-items-center justify-content-between">
            <h2 class="text-center fs-35 fw-light leading-tight">
              Explora los <span class="fw-bold">temas con<br/>más publicaciones</span>
            </h2>
            <div class="col-md-10">
              <ul class="list-inline d-flex flex-wrap justify-content-center mt-16">
                {% for tag in tags %}
                  <li class="py-5">
                    <a href="{% url_for 'dataset.search', tags=tag.name %}" class="btn btn-teal-blue fw-light">
                      {{ tag.display_name | title }}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            </div>
            <a href="#" class="btn btn-lg btn-light mt-20">Ver ranking</a>
          </div>
        </div>
        <div class="col-md-6 has-bg-image" style="background-image: url(/images/waves-orange.jpg);">
          <div class="section d-flex flex-column align-items-center justify-content-between">
            <h2 class="text-center fs-35 fw-light leading-tight">
              Explora las <span class="fw-bold">entidades que más<br/>conjuntos de datos publican</span>
            </h2>
            <div class="col-md-10">
              <ul class="list-inline d-flex flex-wrap justify-content-center mt-16">
                {% for org in organizations %}
                  <li class="py-5">
                    <a href="{% url_for 'dataset.search', organization=org.name %}" class="btn btn-sinopia-i fw-light">
                      {{ org.display_name }}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            </div>
            <a href="#" class="btn btn-lg btn-light mt-20">
              Ver ranking
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="bg-cultured section-lg">
    <div class="container">
      <div class="text-center">
        <h2 class="text-sinopia fw-bold fs-45">
          Los más descargados
        </h2>
        <p class="fs-22 text-blue-sapphire">
          Conoce los conjuntos de datos <span class="fw-bold">más populares</span> en nuestro portal
        </p>
      </div>
      {% set popular_datasets = h.pdae_theme_get_datasets() %}
      {% if popular_datasets %}
        <div class="mt-32">
          {{ h.snippet('home/snippets/pdae_theme_datasets_slider.html', datasets=popular_datasets) }}
        </div>
      {% endif %}
      <div class="text-center mt-128">
        <h2 class="text-sinopia fw-bold fs-45">
          Centro de aprendizaje
        </h2>
        <p class="fs-22 text-blue-sapphire">
          Accede a los <span class="fw-bold">tutoriales de uso</span> de este portal, a <span class="fw-bold">cursos de capacitación en Datos Abiertos</span> y mucho más.
        </p>
      </div>
    </div>
  </section>
  <section class="section has-bg-image text-white" style="background-image: url(/images/textura-datos-naranja.jpg);">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2">
          <div class="text-center">
            <h2 class="fs-35 fw-light leading-tight">
              ¿Qué datos te gustaría acceder desde este <span class="fw-bold">Portal de Datos Abiertos</span>?
            </h2>
            <a href="#" class="btn btn-lg btn-light mt-16">
              Cuéntanos aquí
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
{% endblock %}

{%- block custom_styles %}
  {{ super() }}
  {% asset 'ckanext-pdae_theme/pdae_theme_swiper_css' %}
{% endblock %}

{%- block scripts %}
  {{ super() }}
  {% asset 'ckanext-pdae_theme/pdae_theme_swiper_js' %}
  {% asset 'ckanext-pdae_theme/pdae_theme_slider' %}
{% endblock -%}